.course-header
  %h1
    = course.name
  .course-meta
    = user_avatar(course.instructor, class: 'avatar-circle', alt: course.instructor.name, width: '45px', height: '45px')
    %h5= course.instructor.name
.box
  .box-header.video-container
    = embed_video(course.video)
  .box-content
    %ul.tabs
      %li.tab-button.pull-right
        -if user_signed_in?
          - if !current_user.enrolled?(course) && ( current_user.has_active_subscription? || current_user.purchased?(course) )
            - enrollment = current_user.enrollments.build( course_id: course.id )
            = simple_form_for enrollment, url: course_enrollment_path(course) do |f|
              = f.submit 'Start Course', class: 'button button-purple'
          - elsif current_user.is_admin? || current_user.id == course.instructor_id
            = link_to 'Edit', edit_course_path(course), class: 'button button-green'
            = link_to_if current_user.is_admin?, 'Delete', course_path(course), method: :delete, data: { confirm: 'Are you sure you want to delete this course?' }, class: 'button button-red'
          - elsif !( current_user.has_active_subscription? || current_user.purchased?(course) )
            = link_to t('button.purchase.new'), course_purchase_path(course_id: course.id), class: 'button button-brand'
        - else
          = link_to t('button.subscription.new'), new_subscription_path(plan: 1), class: 'button button-brand'
          = link_to t('button.purchase.new'), course_purchase_path(course_id: course.id), class: 'button button-brand'
      %li.tab-header
        %a.tab-link{ href: 'javascript:void(0)', data: { toggle: 'tab' } } #{ t('course.description') }
        .tab-content
          = course.description
      %li.tab-header
        %a.tab-link{ href: 'javascript:void(0)', data: { toggle: 'tab' } } #{ t('course.curriculum') }
        .tab-content
          = render @sections
